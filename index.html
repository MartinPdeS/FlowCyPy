<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0 ">
    <title>Documentation Versions</title>
</head>
<body>
    <h1>Select Documentation Version</h1>
    <p>If you are not redirected automatically, please choose a version below:</p>
    <ul id="version-list">
        <!-- JavaScript will populate this list dynamically -->
    </ul>

    <script>
        // URL for the version_switcher.json file on GitHub Pages
        const versionJsonUrl = "https://martinpdes.github.io/FlowCyPy/version_switcher.json";

        // Base URL for your GitHub Pages site
        const baseUrl = "https://martinpdes.github.io/FlowCyPy";

        // Function to parse and sort version strings in descending order
        function parseAndSortVersions(versionsData) {
            return versionsData.sort((a, b) => {
                const versionA = a.version.slice(1).split('.').map(Number); // Remove "v" and split
                const versionB = b.version.slice(1).split('.').map(Number);
                for (let i = 0; i < Math.max(versionA.length, versionB.length); i++) {
                    const numA = versionA[i] || 0; // Handle different version lengths
                    const numB = versionB[i] || 0;
                    if (numA !== numB) return numB - numA;
                }
                return 0;
            });
        }

        // Fetch available versions from version_switcher.json
        fetch(versionJsonUrl)
            .then(response => response.json())
            .then(versionsData => {
                console.log("Available documentation versions:", versionsData);

                // Sort versions and redirect to the largest version
                const sortedVersions = parseAndSortVersions(versionsData);
                const latestVersion = sortedVersions[0];

                // Redirect to the largest version by default
                window.location.href = `${baseUrl}/docs/${latestVersion.version}/index.html`;

                // Display a list of all versions as links
                const versionList = document.getElementById('version-list');
                sortedVersions.forEach(entry => {
                    const listItem = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = `${baseUrl}/docs/${entry.version}/index.html`;
                    link.textContent = entry.name || `Version: ${entry.version}`;
                    listItem.appendChild(link);
                    versionList.appendChild(listItem);
                });
            })
            .catch(error => {
                console.error("Error loading versions from version_switcher.json:", error);
                document.body.innerHTML += "<p>Could not load versions. Please try again later.</p>";
            });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Versions</title>
</head>
<body>
    <h1>Select Documentation Version</h1>
    <p>If you are not redirected automatically, please choose a version below:</p>
    <ul id="version-list">
        <!-- JavaScript will populate this list dynamically -->
    </ul>

    <script>
        // URL for the version_switcher.json file on GitHub Pages
        const versionJsonUrl = "https://martinpdes.github.io/FlowCyPy/version_switcher.json";

        // Base URL for your GitHub Pages site
        const baseUrl = "https://martinpdes.github.io/FlowCyPy";

        // Fetch available versions from version_switcher.json
        fetch(versionJsonUrl)
            .then(response => response.json())
            .then(versionsData => {
                console.log("Available documentation versions:", versionsData);

                // Find the 'latest/' version or fallback to the largest version
                const latestEntry = versionsData.find(entry => entry.name === "latest") || versionsData[0];

                // Redirect to the 'latest/' version by default
                window.location.href = `${baseUrl}/docs/${latestEntry.version}/index.html`;

                // Display a list of all versions as links
                const versionList = document.getElementById('version-list');
                versionsData.forEach(entry => {
                    const listItem = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = `${baseUrl}/docs/${entry.version}/index.html`;
                    link.textContent = entry.name || `Version: ${entry.version}`;
                    listItem.appendChild(link);
                    versionList.appendChild(listItem);
                });
            })
            .catch(error => {
                console.error("Error loading versions from version_switcher.json:", error);
                document.body.innerHTML += "<p>Could not load versions. Please try again later.</p>";
            });
    </script>
</body>
</html>

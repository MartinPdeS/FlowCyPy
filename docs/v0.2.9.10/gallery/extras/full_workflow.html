
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simulating and Analyzing Flow Cytometer Signals &#8212; FlowCyPy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/docs/source/_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css?v=265c6c44" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/extras/full_workflow';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/MartinPdeS/FlowCyPy/documentation_page/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v0.2.9.10';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../_static/thumbnail.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Flow Cytometry Simulation and 2D Hexbin Plot of Scattering Intensities" href="scatterer_distribution.html" />
    <link rel="prev" title="Simulating Flow Cytometer Signals with Rayleigh Scattering" href="flow_cytometer_signal.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.2.9.10" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/thumbnail.png" class="logo__image only-light" alt=""/>
    <img src="../../_static/thumbnail.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">FlowCyPy</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code.html">
    Code Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../examples.html">
    Coding examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../theory.html">
    Theoretical Background
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MartinPdeS/FlowCyPy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/FlowCyPy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://anaconda.org/MartinPdeS/FlowCyPy" title="Anaconda" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Anaconda</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code.html">
    Code Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../examples.html">
    Coding examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../theory.html">
    Theoretical Background
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../references.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MartinPdeS/FlowCyPy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/FlowCyPy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://anaconda.org/MartinPdeS/FlowCyPy" title="Anaconda" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Anaconda</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../density_plots/index.html">Examples: Density plots</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../density_plots/1_populations.html">Flow Cytometry Simulation with One Populations: Density Plot of Scattering Intensities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../density_plots/2_populations.html">Flow Cytometry Simulation [2 populations] Density Plot of Scattering Intensities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../density_plots/3_populations.html">Flow Cytometry Simulation with Two Populations: Density Plot of Scattering Intensities</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Examples: extras</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="distributions.html">Particle Size Distribution Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="flow_cytometer_signal.html">Simulating Flow Cytometer Signals with Rayleigh Scattering</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Simulating and Analyzing Flow Cytometer Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="scatterer_distribution.html">Flow Cytometry Simulation and 2D Hexbin Plot of Scattering Intensities</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../examples.html" class="nav-link">Coding examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples: extras</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Simulating and Analyzing Flow Cytometer Signals</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-gallery-extras-full-workflow-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="simulating-and-analyzing-flow-cytometer-signals">
<span id="sphx-glr-gallery-extras-full-workflow-py"></span><h1>Simulating and Analyzing Flow Cytometer Signals<a class="headerlink" href="#simulating-and-analyzing-flow-cytometer-signals" title="Link to this heading">#</a></h1>
<p>This script simulates flow cytometer signals using the <cite>FlowCytometer</cite> class and analyzes the results using
the <cite>PulseAnalyzer</cite> class from the FlowCyPy library. The signals generated (forward scatter and side scatter)
provide insights into the physical properties of particles passing through the laser beam.</p>
<section id="workflow">
<h2>Workflow:<a class="headerlink" href="#workflow" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Define a particle size distribution using <cite>Scatterer</cite>.</p></li>
<li><p>Simulate flow cytometer signals using <cite>FlowCytometer</cite>.</p></li>
<li><p>Analyze the forward scatter signal with <cite>PulseAnalyzer</cite> to extract features like peak height, width, and area.</p></li>
<li><p>Visualize the generated signals and display the extracted pulse features.</p></li>
</ol>
<p>Step 1: Import necessary modules from FlowCyPy</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">FlowCyPy</span> <span class="kn">import</span> <span class="n">FlowCytometer</span><span class="p">,</span> <span class="n">Scatterer</span><span class="p">,</span> <span class="n">Detector</span><span class="p">,</span> <span class="n">Source</span><span class="p">,</span> <span class="n">FlowCell</span>
<span class="kn">from</span> <span class="nn">FlowCyPy</span> <span class="kn">import</span> <span class="n">distribution</span>
<span class="kn">from</span> <span class="nn">FlowCyPy.population</span> <span class="kn">import</span> <span class="n">Population</span>
<span class="kn">from</span> <span class="nn">FlowCyPy.units</span> <span class="kn">import</span> <span class="n">nanometer</span><span class="p">,</span> <span class="n">millisecond</span><span class="p">,</span> <span class="n">meter</span><span class="p">,</span> <span class="n">micrometer</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">RIU</span><span class="p">,</span> <span class="n">milliliter</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">millivolt</span><span class="p">,</span> <span class="n">watt</span><span class="p">,</span> <span class="n">megahertz</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="n">ampere</span><span class="p">,</span> <span class="n">milliwatt</span><span class="p">,</span> <span class="n">AU</span>
</pre></div>
</div>
</section>
<section id="step-2-define-flow-parameters">
<h2>Step 2: Define flow parameters<a class="headerlink" href="#step-2-define-flow-parameters" title="Link to this heading">#</a></h2>
<p>Set the flow speed to 80 micrometers per second and a flow area of 1 square micrometer, with a total simulation time of 1 second.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">flow_cell</span> <span class="o">=</span> <span class="n">FlowCell</span><span class="p">(</span>
    <span class="n">flow_speed</span><span class="o">=</span><span class="mf">7.56</span> <span class="o">*</span> <span class="n">meter</span> <span class="o">/</span> <span class="n">second</span><span class="p">,</span>        <span class="c1"># Flow speed: 7.56 meters per second</span>
    <span class="n">flow_area</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">micrometer</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>        <span class="c1"># Flow area: 10 x 10 micrometers</span>
    <span class="n">run_time</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">millisecond</span>             <span class="c1"># Total simulation time: 0.3 milliseconds</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-3-define-the-particle-size-distribution">
<h2>Step 3: Define the particle size distribution<a class="headerlink" href="#step-3-define-the-particle-size-distribution" title="Link to this heading">#</a></h2>
<p>Use a normal size distribution with a mean size of 200 nanometers and a standard deviation of 10 nanometers.
This represents the population of scatterers (particles) that will interact with the laser source.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ev_size</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="mi">200</span> <span class="o">*</span> <span class="n">nanometer</span><span class="p">,</span>       <span class="c1"># Mean particle size: 200 nanometers</span>
    <span class="n">std_dev</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">nanometer</span>      <span class="c1"># Standard deviation: 10 nanometers</span>
<span class="p">)</span>

<span class="n">ev_ri</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="mf">1.39</span> <span class="o">*</span> <span class="n">RIU</span><span class="p">,</span>    <span class="c1"># Mean refractive index: 1.39</span>
    <span class="n">std_dev</span><span class="o">=</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">RIU</span>  <span class="c1"># Standard deviation: 0.01</span>
<span class="p">)</span>

<span class="n">ev</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span>
    <span class="n">size</span><span class="o">=</span><span class="n">ev_size</span><span class="p">,</span>               <span class="c1"># Particle size distribution</span>
    <span class="n">refractive_index</span><span class="o">=</span><span class="n">ev_ri</span><span class="p">,</span>     <span class="c1"># Refractive index distribution</span>
    <span class="n">concentration</span><span class="o">=</span><span class="mf">1.8e+9</span> <span class="o">*</span> <span class="n">particle</span> <span class="o">/</span> <span class="n">milliliter</span><span class="p">,</span>  <span class="c1"># Particle concentration: 1.8 million particles per milliliter</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;EV&#39;</span>                   <span class="c1"># Name of the particle population: Extracellular Vesicles (EV)</span>
<span class="p">)</span>

<span class="n">scatterer</span> <span class="o">=</span> <span class="n">Scatterer</span><span class="p">(</span><span class="n">populations</span><span class="o">=</span><span class="p">[</span><span class="n">ev</span><span class="p">])</span>

<span class="n">scatterer</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">flow_cell</span><span class="o">=</span><span class="n">flow_cell</span><span class="p">)</span>

<span class="c1"># Plot the scatterer distribution</span>
<span class="n">scatterer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_full_workflow_001.png" srcset="../../_images/sphx_glr_full_workflow_001.png" alt="full workflow" class = "sphx-glr-single-img"/></section>
<section id="step-4-define-the-laser-source">
<h2>Step 4: Define the laser source<a class="headerlink" href="#step-4-define-the-laser-source" title="Link to this heading">#</a></h2>
<p>Set up a laser source with a wavelength of 1550 nm, optical power of 200 mW, and a numerical aperture of 0.3.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">Source</span><span class="p">(</span>
    <span class="n">numerical_aperture</span><span class="o">=</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">AU</span><span class="p">,</span>  <span class="c1"># Numerical aperture: 0.3</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="mi">800</span> <span class="o">*</span> <span class="n">nanometer</span><span class="p">,</span>   <span class="c1"># Laser wavelength: 800 nm</span>
    <span class="n">optical_power</span><span class="o">=</span><span class="mi">20</span> <span class="o">*</span> <span class="n">milliwatt</span>  <span class="c1"># Optical power: 20 milliwatts</span>
<span class="p">)</span>

<span class="c1"># Step 5: Define the detector</span>
<span class="c1"># ---------------------------</span>
<span class="c1"># The detector captures the scattered light. It is positioned at 90 degrees relative to the incident light beam</span>
<span class="c1"># and configured with a numerical aperture of 0.4 and responsitivity of 1.</span>
<span class="n">detector_0</span> <span class="o">=</span> <span class="n">Detector</span><span class="p">(</span>
    <span class="n">phi_angle</span><span class="o">=</span><span class="mi">90</span> <span class="o">*</span> <span class="n">degree</span><span class="p">,</span>              <span class="c1"># Detector angle: 90 degrees (Side Scatter)</span>
    <span class="n">numerical_aperture</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">AU</span><span class="p">,</span>        <span class="c1"># Numerical aperture of the detector</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;first detector&#39;</span><span class="p">,</span>              <span class="c1"># Detector name</span>
    <span class="n">responsitivity</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">ampere</span> <span class="o">/</span> <span class="n">watt</span><span class="p">,</span>   <span class="c1"># Responsitivity of the detector (light to signal conversion efficiency)</span>
    <span class="n">sampling_freq</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">megahertz</span><span class="p">,</span>        <span class="c1"># Sampling frequency: 10,000 Hz</span>
    <span class="n">saturation_level</span><span class="o">=</span><span class="mi">40</span> <span class="o">*</span> <span class="n">millivolt</span><span class="p">,</span>    <span class="c1"># Saturation level: Large enough to avoid saturation</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="s1">&#39;14bit&#39;</span>                      <span class="c1"># Number of bins for signal discretization: 1024</span>
<span class="p">)</span>

<span class="n">detector_1</span> <span class="o">=</span> <span class="n">Detector</span><span class="p">(</span>
    <span class="n">phi_angle</span><span class="o">=</span><span class="mi">0</span> <span class="o">*</span> <span class="n">degree</span><span class="p">,</span>               <span class="c1"># Detector angle: 90 degrees (Sid e Scatter)</span>
    <span class="n">numerical_aperture</span><span class="o">=</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">AU</span><span class="p">,</span>        <span class="c1"># Numerical aperture of the detector</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;second detector&#39;</span><span class="p">,</span>             <span class="c1"># Detector name</span>
    <span class="n">responsitivity</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">ampere</span> <span class="o">/</span> <span class="n">watt</span><span class="p">,</span>   <span class="c1"># Responsitivity of the detector (light to signal conversion efficiency)</span>
    <span class="n">sampling_freq</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">megahertz</span><span class="p">,</span>        <span class="c1"># Sampling frequency: 10,000 Hz</span>
    <span class="n">saturation_level</span><span class="o">=</span><span class="mi">40</span> <span class="o">*</span> <span class="n">millivolt</span><span class="p">,</span>    <span class="c1"># Saturation level: Large enough to avoid saturation</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="s1">&#39;14bit&#39;</span><span class="p">,</span>                     <span class="c1"># Number of bins for signal discretization: 1024</span>
    <span class="n">include_shot_noise</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Step 6: Simulate Flow Cytometer Signals</span>
<span class="c1"># ---------------------------------------</span>
<span class="c1"># Create a FlowCytometer instance to simulate the signals generated as particles pass through the laser beam.</span>
<span class="n">cytometer</span> <span class="o">=</span> <span class="n">FlowCytometer</span><span class="p">(</span>
    <span class="n">coupling_mechanism</span><span class="o">=</span><span class="s1">&#39;mie&#39;</span><span class="p">,</span>           <span class="c1"># Scattering model: Empirical (Rayleigh scattering for small particles)</span>
    <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>                      <span class="c1"># Laser source</span>
    <span class="n">scatterer</span><span class="o">=</span><span class="n">scatterer</span><span class="p">,</span>                <span class="c1"># Particle size distribution</span>
    <span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="n">detector_0</span><span class="p">,</span> <span class="n">detector_1</span><span class="p">]</span>  <span class="c1"># List of detectors used in the simulation</span>
<span class="p">)</span>

<span class="c1"># Simulate the pulse signals generated from the interaction between particles and the laser.</span>
<span class="n">cytometer</span><span class="o">.</span><span class="n">simulate_pulse</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="step-7-analyze-and-visualize-results">
<h2>Step 7: Analyze and Visualize Results<a class="headerlink" href="#step-7-analyze-and-visualize-results" title="Link to this heading">#</a></h2>
<p>Display the properties of the simulated cytometer setup, including flow speed and laser power.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cytometer</span><span class="o">.</span><span class="n">print_properties</span><span class="p">()</span>

<span class="c1"># Plot the simulated signals for the detector.</span>
<span class="n">cytometer</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Summary:</span>
<span class="sd">--------</span>
<span class="sd">This script simulates flow cytometer signals, processes them to detect peaks in the forward scatter channel,</span>
<span class="sd">and extracts important features. The process is visualized through signal plots, and key properties are displayed.</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_full_workflow_002.png" srcset="../../_images/sphx_glr_full_workflow_002.png" alt="full workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Scatterer [] Properties
+-----------------------------+----------+
| Property                    | Value    |
+=============================+==========+
| coupling factor             | mie      |
+-----------------------------+----------+
| medium refractive index     | 1.0 RIU  |
+-----------------------------+----------+
| minimum time between events | 19.9 ps  |
+-----------------------------+----------+
| average time between events | 176.5 ns |
+-----------------------------+----------+

Population [EV] Properties
+------------------+-------------------------------+
| Property         | Value                         |
+==================+===============================+
| Name             | EV                            |
+------------------+-------------------------------+
| Refractive Index | Normal(1.390 RIU, 0.010 RIU)  |
+------------------+-------------------------------+
| Size             | Normal(200.000 nm, 10.000 nm) |
+------------------+-------------------------------+
| Concentration    | 3.0 nmol/m³                   |
+------------------+-------------------------------+
| N events         | 2.7 kparticle                 |
+------------------+-------------------------------+

FlowCytometer Properties

Source [] Properties
+------------+---------+
| Property   | Value   |
+============+=========+
+------------+---------+

Detector [first detector] Properties
+--------------------+----------+
| Property           | Value    |
+====================+==========+
| Sampling frequency | 1.0 MHz  |
+--------------------+----------+
| Phi angle          | 90.0 deg |
+--------------------+----------+
| Gamma angle        | 0.0 deg  |
+--------------------+----------+
| Numerical aperture | 0.4      |
+--------------------+----------+
| Responsitivity     | 1.0 A/W  |
+--------------------+----------+
| Saturation Level   | 40.0 mV  |
+--------------------+----------+
| Dark Current       | 0.0 A    |
+--------------------+----------+
| Resistance         | 50.0 Ω   |
+--------------------+----------+
| Temperature        | 0.0 K    |
+--------------------+----------+
| N Bins             | 16384    |
+--------------------+----------+

Detector [second detector] Properties
+--------------------+---------+
| Property           | Value   |
+====================+=========+
| Sampling frequency | 2.0 MHz |
+--------------------+---------+
| Phi angle          | 0.0 deg |
+--------------------+---------+
| Gamma angle        | 0.0 deg |
+--------------------+---------+
| Numerical aperture | 0.4     |
+--------------------+---------+
| Responsitivity     | 1.0 A/W |
+--------------------+---------+
| Saturation Level   | 40.0 mV |
+--------------------+---------+
| Dark Current       | 0.0 A   |
+--------------------+---------+
| Resistance         | 50.0 Ω  |
+--------------------+---------+
| Temperature        | 0.0 K   |
+--------------------+---------+
| N Bins             | 16384   |
+--------------------+---------+

&#39;\nSummary:\n--------\nThis script simulates flow cytometer signals, processes them to detect peaks in the forward scatter channel,\nand extracts important features. The process is visualized through signal plots, and key properties are displayed.\n&#39;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 3.862 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-extras-full-workflow-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7765c7c9dfbad7ed6be152008ccfca41/full_workflow.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">full_workflow.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5f893d0a6e18bc947f8a9b8a8db9f186/full_workflow.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">full_workflow.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/aff8634fd0749a99e4a01ab73095c6f5/full_workflow.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">full_workflow.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow">Workflow:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-define-flow-parameters">Step 2: Define flow parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-define-the-particle-size-distribution">Step 3: Define the particle size distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-define-the-laser-source">Step 4: Define the laser source</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-analyze-and-visualize-results">Step 7: Analyze and Visualize Results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/gallery/extras/full_workflow.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Martin Poinsinet de Sivry-Houle.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>